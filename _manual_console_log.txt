S E:\CODE\SRP> & C:/Users/cmz/AppData/Local/Programs/Python/Python311/python.exe e:/CODE/SRP/train.py
============================================================
纤维图像分类训练开始 - 分别训练光镜和电镜模型
============================================================
检测到CUDA设备: NVIDIA GeForce RTX 4060 Laptop GPU
GPU内存: 8.0 GB
============================================================

开始训练光镜(Optical)模型...

============================================================
开始训练 OPTICAL 显微镜模型
============================================================
使用设备: cuda
GPU设备名称: NVIDIA GeForce RTX 4060 Laptop GPU
GPU内存: 8.0 GB

加载 optical 数据集...
加载 optical 显微镜数据...
处理文件夹: optical
总共加载了 147 张图像
20CS19764 鼠皮树: 24 张图像
DH001 粽叶芦: 34 张图像
JL001 怀槐: 19 张图像
JL005 蒙古栎: 6 张图像
LiYLXWZW002 长叶水麻: 34 张图像
XZYGX023 硬头黄: 30 张图像

划分数据集...
训练集: 87 张图像
验证集: 30 张图像
测试集: 30 张图像

创建模型...
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)

开始训练...

Epoch 1/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:09<00:00,  3.12s/it, Loss=1.5757, Acc=18.39%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.55s/it, Loss=5.4744, Acc=36.67%] 
Train Loss: 1.7356, Train Acc: 18.39%
Val Loss: 5.4744, Val Acc: 36.67%
Best Val Acc: 36.67%

Epoch 2/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.88s/it, Loss=1.0185, Acc=42.53%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.06s/it, Loss=1.7297, Acc=23.33%] 
Train Loss: 1.4082, Train Acc: 42.53%
Val Loss: 1.7297, Val Acc: 23.33%
Best Val Acc: 36.67%

Epoch 3/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.68s/it, Loss=1.5069, Acc=42.53%] 
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.70s/it, Loss=60.6258, Acc=23.33%] 
Train Loss: 1.4061, Train Acc: 42.53%
Val Loss: 60.6258, Val Acc: 23.33%
Best Val Acc: 36.67%

Epoch 4/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.67s/it, Loss=0.9307, Acc=52.87%] 
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.90s/it, Loss=17.5931, Acc=36.67%] 
Train Loss: 1.1082, Train Acc: 52.87%
Val Loss: 17.5931, Val Acc: 36.67%
Best Val Acc: 36.67%

Epoch 5/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.93s/it, Loss=1.5602, Acc=49.43%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  7.00s/it, Loss=9.6239, Acc=50.00%] 
Train Loss: 1.4095, Train Acc: 49.43%
Val Loss: 9.6239, Val Acc: 50.00%
Best Val Acc: 50.00%

Epoch 6/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.83s/it, Loss=1.0512, Acc=52.87%] 
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.17s/it, Loss=20.0166, Acc=50.00%] 
Train Loss: 1.1144, Train Acc: 52.87%
Val Loss: 20.0166, Val Acc: 50.00%
Best Val Acc: 50.00%

Epoch 7/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.74s/it, Loss=0.6641, Acc=63.22%] 
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.20s/it, Loss=13.6281, Acc=40.00%] 
Train Loss: 0.8527, Train Acc: 63.22%
Val Loss: 13.6281, Val Acc: 40.00%
Best Val Acc: 50.00%

Epoch 8/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.86s/it, Loss=1.0441, Acc=58.62%] 
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.35s/it, Loss=15.6574, Acc=33.33%] 
Train Loss: 1.1084, Train Acc: 58.62%
Val Loss: 15.6574, Val Acc: 33.33%
Best Val Acc: 50.00%

Epoch 9/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.83s/it, Loss=1.1262, Acc=62.07%] 
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.83s/it, Loss=11.0243, Acc=43.33%] 
Train Loss: 0.9121, Train Acc: 62.07%
Val Loss: 11.0243, Val Acc: 43.33%
Best Val Acc: 50.00%

Epoch 10/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.79s/it, Loss=0.7847, Acc=71.26%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.81s/it, Loss=1.9415, Acc=70.00%] 
Train Loss: 0.8114, Train Acc: 71.26%
Val Loss: 1.9415, Val Acc: 70.00%
Best Val Acc: 70.00%

Epoch 11/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.87s/it, Loss=0.8585, Acc=67.82%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.19s/it, Loss=1.0898, Acc=70.00%] 
Train Loss: 0.7981, Train Acc: 67.82%
Val Loss: 1.0898, Val Acc: 70.00%
Best Val Acc: 70.00%

Epoch 12/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.80s/it, Loss=0.6168, Acc=78.16%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.03s/it, Loss=0.8961, Acc=66.67%] 
Train Loss: 0.5517, Train Acc: 78.16%
Val Loss: 0.8961, Val Acc: 66.67%
Best Val Acc: 70.00%

Epoch 13/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.96s/it, Loss=0.9304, Acc=77.01%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.86s/it, Loss=1.5803, Acc=66.67%] 
Train Loss: 0.7564, Train Acc: 77.01%
Val Loss: 1.5803, Val Acc: 66.67%
Best Val Acc: 70.00%

Epoch 14/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.92s/it, Loss=0.8995, Acc=73.56%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.86s/it, Loss=0.9278, Acc=73.33%] 
Train Loss: 0.7379, Train Acc: 73.56%
Val Loss: 0.9278, Val Acc: 73.33%
Best Val Acc: 73.33%

Epoch 15/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:07<00:00,  2.65s/it, Loss=0.8367, Acc=77.01%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.09s/it, Loss=0.7497, Acc=76.67%] 
Train Loss: 0.6938, Train Acc: 77.01%
Val Loss: 0.7497, Val Acc: 76.67%
Best Val Acc: 76.67%

Epoch 16/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.88s/it, Loss=0.6845, Acc=71.26%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.07s/it, Loss=0.6938, Acc=80.00%] 
Train Loss: 0.7617, Train Acc: 71.26%
Val Loss: 0.6938, Val Acc: 80.00%
Best Val Acc: 80.00%

Epoch 17/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:09<00:00,  3.10s/it, Loss=0.5755, Acc=73.56%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.00s/it, Loss=0.6189, Acc=80.00%] 
Train Loss: 0.6985, Train Acc: 73.56%
Val Loss: 0.6189, Val Acc: 80.00%
Best Val Acc: 80.00%

Epoch 18/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.97s/it, Loss=0.2891, Acc=81.61%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.90s/it, Loss=0.5775, Acc=80.00%] 
Val Loss: 0.5775, Val Acc: 80.00%
Best Val Acc: 80.00%

Epoch 19/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.82s/it, Loss=0.7269, Acc=74.71%]
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.87s/it, Loss=0.5289, Acc=83.33%]
Train Loss: 0.6967, Train Acc: 74.71%
Val Loss: 0.5289, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 20/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.69s/it, Loss=0.5705, Acc=77.01%]
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.94s/it, Loss=0.4654, Acc=83.33%]
Train Loss: 0.6335, Train Acc: 77.01%
Val Loss: 0.4654, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 21/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.93s/it, Loss=0.5661, Acc=79.31%]
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.83s/it, Loss=0.3874, Acc=83.33%]
Train Loss: 0.5423, Train Acc: 79.31%
Val Loss: 0.3874, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 22/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.95s/it, Loss=0.5140, Acc=73.56%]
Validation:   0%|                                                                                                                                                                                         Validation:   0%|                                                                                                                                                                                         
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.83s/it, Loss=0.4089, Acc=83.33%]
Train Loss: 0.6298, Train Acc: 73.56%
Val Loss: 0.4089, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 23/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.84s/it, Loss=0.4483, Acc=86.21%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.97s/it, Loss=0.4479, Acc=80.00%] 
Train Loss: 0.4487, Train Acc: 86.21%
Val Loss: 0.4479, Val Acc: 80.00%
Best Val Acc: 83.33%

Epoch 24/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:09<00:00,  3.22s/it, Loss=0.5460, Acc=77.01%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.55s/it, Loss=0.4659, Acc=80.00%] 
Train Loss: 0.5503, Train Acc: 77.01%
Val Loss: 0.4659, Val Acc: 80.00%
Best Val Acc: 83.33%

Epoch 25/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.85s/it, Loss=0.4068, Acc=89.66%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.90s/it, Loss=0.4546, Acc=80.00%] 
Train Loss: 0.3717, Train Acc: 89.66%
Val Loss: 0.4546, Val Acc: 80.00%
Best Val Acc: 83.33%

Epoch 26/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.91s/it, Loss=0.3031, Acc=93.10%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.06s/it, Loss=0.4539, Acc=80.00%] 
Train Loss: 0.3086, Train Acc: 93.10%
Val Loss: 0.4539, Val Acc: 80.00%
Best Val Acc: 83.33%

Epoch 27/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.75s/it, Loss=0.5002, Acc=87.36%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.98s/it, Loss=0.4601, Acc=80.00%] 
Train Loss: 0.3634, Train Acc: 87.36%
Val Loss: 0.4601, Val Acc: 80.00%
Best Val Acc: 83.33%

Epoch 28/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.83s/it, Loss=0.5318, Acc=88.51%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.68s/it, Loss=0.4707, Acc=76.67%] 
Train Loss: 0.4198, Train Acc: 88.51%
Val Loss: 0.4707, Val Acc: 76.67%
Best Val Acc: 83.33%

Epoch 29/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.72s/it, Loss=0.5626, Acc=90.80%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.64s/it, Loss=0.4327, Acc=80.00%] 
Train Loss: 0.3417, Train Acc: 90.80%
Val Loss: 0.4327, Val Acc: 80.00%
Best Val Acc: 83.33%

Epoch 30/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.78s/it, Loss=0.5383, Acc=82.76%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.45s/it, Loss=0.4004, Acc=83.33%] 
Train Loss: 0.3822, Train Acc: 82.76%
Val Loss: 0.4004, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 31/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.90s/it, Loss=0.2861, Acc=88.51%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.73s/it, Loss=0.3915, Acc=83.33%] 
Train Loss: 0.3530, Train Acc: 88.51%
Val Loss: 0.3915, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 32/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.70s/it, Loss=0.2735, Acc=89.66%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.63s/it, Loss=0.3998, Acc=83.33%] 
Train Loss: 0.3241, Train Acc: 89.66%
Val Loss: 0.3998, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 33/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:07<00:00,  2.59s/it, Loss=0.5425, Acc=90.80%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.67s/it, Loss=0.4041, Acc=83.33%] 
Train Loss: 0.3160, Train Acc: 90.80%
Val Loss: 0.4041, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 34/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.69s/it, Loss=0.2591, Acc=88.51%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.99s/it, Loss=0.3994, Acc=83.33%] 
Train Loss: 0.3915, Train Acc: 88.51%
Val Loss: 0.3994, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 35/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.79s/it, Loss=0.3299, Acc=85.06%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.77s/it, Loss=0.4099, Acc=83.33%] 
Train Loss: 0.3482, Train Acc: 85.06%
Val Loss: 0.4099, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 36/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.95s/it, Loss=0.4691, Acc=90.80%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.86s/it, Loss=0.4160, Acc=83.33%] 
Train Loss: 0.3211, Train Acc: 90.80%
Val Loss: 0.4160, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 37/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:07<00:00,  2.65s/it, Loss=0.2378, Acc=86.21%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.09s/it, Loss=0.4093, Acc=83.33%] 
Train Loss: 0.3532, Train Acc: 86.21%
Val Loss: 0.4093, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 38/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:07<00:00,  2.65s/it, Loss=0.4292, Acc=89.66%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.79s/it, Loss=0.4251, Acc=83.33%] 
Train Loss: 0.3512, Train Acc: 89.66%
Val Loss: 0.4251, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 39/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.74s/it, Loss=0.4982, Acc=90.80%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.82s/it, Loss=0.4242, Acc=83.33%] 
Train Loss: 0.3220, Train Acc: 90.80%
Val Loss: 0.4242, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 40/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.98s/it, Loss=0.2955, Acc=83.91%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.08s/it, Loss=0.4480, Acc=80.00%] 
Train Loss: 0.4052, Train Acc: 83.91%
Val Loss: 0.4480, Val Acc: 80.00%
Best Val Acc: 83.33%

Epoch 41/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.77s/it, Loss=0.1550, Acc=91.95%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.86s/it, Loss=0.4242, Acc=83.33%] 
Train Loss: 0.2980, Train Acc: 91.95%
Val Loss: 0.4242, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 42/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.75s/it, Loss=0.2245, Acc=89.66%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.73s/it, Loss=0.4041, Acc=83.33%] 
Train Loss: 0.2849, Train Acc: 89.66%
Val Loss: 0.4041, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 43/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.79s/it, Loss=0.2031, Acc=87.36%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.94s/it, Loss=0.3833, Acc=83.33%] 
Train Loss: 0.3204, Train Acc: 87.36%
Val Loss: 0.3833, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 44/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:07<00:00,  2.65s/it, Loss=0.3777, Acc=87.36%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.67s/it, Loss=0.3855, Acc=83.33%] 
Train Loss: 0.3300, Train Acc: 87.36%
Val Loss: 0.3855, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 45/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:07<00:00,  2.65s/it, Loss=0.4954, Acc=87.36%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.68s/it, Loss=0.3862, Acc=83.33%] 
Train Loss: 0.3390, Train Acc: 87.36%
Val Loss: 0.3862, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 46/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.84s/it, Loss=0.3612, Acc=83.91%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.65s/it, Loss=0.3963, Acc=83.33%] 
Train Loss: 0.3543, Train Acc: 83.91%
Val Loss: 0.3963, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 47/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.72s/it, Loss=0.3449, Acc=83.91%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.73s/it, Loss=0.4065, Acc=83.33%] 
Train Loss: 0.3685, Train Acc: 83.91%
Val Loss: 0.4065, Val Acc: 83.33%
Best Val Acc: 83.33%

Epoch 48/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.74s/it, Loss=0.3177, Acc=90.80%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.77s/it, Loss=0.4118, Acc=86.67%] 
Train Loss: 0.2990, Train Acc: 90.80%
Val Loss: 0.4118, Val Acc: 86.67%
Best Val Acc: 86.67%

Epoch 49/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.73s/it, Loss=0.2800, Acc=94.25%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.71s/it, Loss=0.4130, Acc=86.67%] 
Train Loss: 0.2678, Train Acc: 94.25%
Val Loss: 0.4130, Val Acc: 86.67%
Best Val Acc: 86.67%

Epoch 50/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:08<00:00,  2.71s/it, Loss=0.0646, Acc=88.51%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.67s/it, Loss=0.4154, Acc=86.67%] 
Train Loss: 0.2869, Train Acc: 88.51%
Val Loss: 0.4154, Val Acc: 86.67%
Best Val Acc: 86.67%

训练完成！总用时: 12.79 分钟

在测试集上评估...
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:07<00:00,  7.38s/it, Loss=0.4614, Acc=86.67%] 
Test Loss: 0.4614, Test Acc: 86.67%

分类报告:
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\metrics\_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\metrics\_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\metrics\_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
                  precision    recall  f1-score   support

   20CS19764 鼠皮树       0.80      0.80      0.80         5
       DH001 粽叶芦       1.00      1.00      1.00         7
        JL001 怀槐       0.75      0.75      0.75         4
       JL005 蒙古栎       0.00      0.00      0.00         1
LiYLXWZW002 长叶水麻       1.00      1.00      1.00         7
    XZYGX023 硬头黄       0.71      0.83      0.77         6

        accuracy                           0.87        30
       macro avg       0.71      0.73      0.72        30
    weighted avg       0.84      0.87      0.85        30


模型已保存为: fiber_classifier_resnet50_optical.pth

绘制训练历史...
绘制混淆矩阵...
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 40736 (\N{CJK UNIFIED IDEOGRAPH-9F20}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 30382 (\N{CJK UNIFIED IDEOGRAPH-76AE}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 26641 (\N{CJK UNIFIED IDEOGRAPH-6811}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 31933 (\N{CJK UNIFIED IDEOGRAPH-7CBD}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 21494 (\N{CJK UNIFIED IDEOGRAPH-53F6}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 33446 (\N{CJK UNIFIED IDEOGRAPH-82A6}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 24576 (\N{CJK UNIFIED IDEOGRAPH-6000}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 27088 (\N{CJK UNIFIED IDEOGRAPH-69D0}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 33945 (\N{CJK UNIFIED IDEOGRAPH-8499}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 21476 (\N{CJK UNIFIED IDEOGRAPH-53E4}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 26638 (\N{CJK UNIFIED IDEOGRAPH-680E}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 38271 (\N{CJK UNIFIED IDEOGRAPH-957F}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 27700 (\N{CJK UNIFIED IDEOGRAPH-6C34}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 40635 (\N{CJK UNIFIED IDEOGRAPH-9EBB}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 30828 (\N{CJK UNIFIED IDEOGRAPH-786C}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 22836 (\N{CJK UNIFIED IDEOGRAPH-5934}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 40644 (\N{CJK UNIFIED IDEOGRAPH-9EC4}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
e:\CODE\SRP\train.py:291: UserWarning: Glyph 40736 (\N{CJK UNIFIED IDEOGRAPH-9F20}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 30382 (\N{CJK UNIFIED IDEOGRAPH-76AE}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 26641 (\N{CJK UNIFIED IDEOGRAPH-6811}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 31933 (\N{CJK UNIFIED IDEOGRAPH-7CBD}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 21494 (\N{CJK UNIFIED IDEOGRAPH-53F6}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 33446 (\N{CJK UNIFIED IDEOGRAPH-82A6}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 24576 (\N{CJK UNIFIED IDEOGRAPH-6000}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 27088 (\N{CJK UNIFIED IDEOGRAPH-69D0}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 33945 (\N{CJK UNIFIED IDEOGRAPH-8499}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 21476 (\N{CJK UNIFIED IDEOGRAPH-53E4}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 26638 (\N{CJK UNIFIED IDEOGRAPH-680E}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 38271 (\N{CJK UNIFIED IDEOGRAPH-957F}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 27700 (\N{CJK UNIFIED IDEOGRAPH-6C34}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 40635 (\N{CJK UNIFIED IDEOGRAPH-9EBB}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 30828 (\N{CJK UNIFIED IDEOGRAPH-786C}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 22836 (\N{CJK UNIFIED IDEOGRAPH-5934}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 40644 (\N{CJK UNIFIED IDEOGRAPH-9EC4}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 40736 (\N{CJK UNIFIED IDEOGRAPH-9F20}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 30382 (\N{CJK UNIFIED IDEOGRAPH-76AE}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 26641 (\N{CJK UNIFIED IDEOGRAPH-6811}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 31933 (\N{CJK UNIFIED IDEOGRAPH-7CBD}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 21494 (\N{CJK UNIFIED IDEOGRAPH-53F6}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 33446 (\N{CJK UNIFIED IDEOGRAPH-82A6}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 24576 (\N{CJK UNIFIED IDEOGRAPH-6000}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 27088 (\N{CJK UNIFIED IDEOGRAPH-69D0}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 33945 (\N{CJK UNIFIED IDEOGRAPH-8499}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 21476 (\N{CJK UNIFIED IDEOGRAPH-53E4}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 26638 (\N{CJK UNIFIED IDEOGRAPH-680E}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 38271 (\N{CJK UNIFIED IDEOGRAPH-957F}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 27700 (\N{CJK UNIFIED IDEOGRAPH-6C34}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 40635 (\N{CJK UNIFIED IDEOGRAPH-9EBB}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 30828 (\N{CJK UNIFIED IDEOGRAPH-786C}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 22836 (\N{CJK UNIFIED IDEOGRAPH-5934}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 40644 (\N{CJK UNIFIED IDEOGRAPH-9EC4}) missing from font(s) DejaVu Sans.
  func(*args)

OPTICAL 模型训练完成！

开始训练电镜(Electron)模型...

============================================================
开始训练 ELECTRON 显微镜模型
============================================================
使用设备: cuda
GPU设备名称: NVIDIA GeForce RTX 4060 Laptop GPU
GPU内存: 8.0 GB

加载 electron 数据集...
加载 electron 显微镜数据...
处理文件夹: electron
总共加载了 148 张图像
20CS19764 鼠皮树: 18 张图像
DH001 粽叶芦: 31 张图像
JL001 怀槐: 35 张图像
JL005 蒙古栎: 27 张图像
LiYLXWZW002 长叶水麻: 15 张图像
XZYGX023 硬头黄: 22 张图像

划分数据集...
训练集: 88 张图像
验证集: 30 张图像
测试集: 30 张图像

创建模型...
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)

开始训练...

Epoch 1/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:07<00:00,  2.34s/it, Loss=1.7192, Acc=23.86%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.06s/it, Loss=2.1872, Acc=20.00%] 
Train Loss: 1.9369, Train Acc: 23.86%
Val Loss: 2.1872, Val Acc: 20.00%
Best Val Acc: 20.00%

Epoch 2/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.18s/it, Loss=2.0049, Acc=21.59%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.97s/it, Loss=1.8259, Acc=23.33%] 
Train Loss: 1.9778, Train Acc: 21.59%
Val Loss: 1.8259, Val Acc: 23.33%
Best Val Acc: 23.33%

Epoch 3/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.22s/it, Loss=1.5269, Acc=36.36%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.98s/it, Loss=1.8800, Acc=30.00%] 
Train Loss: 1.6238, Train Acc: 36.36%
Val Loss: 1.8800, Val Acc: 30.00%
Best Val Acc: 30.00%

Epoch 4/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.27s/it, Loss=1.9905, Acc=42.05%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.27s/it, Loss=3.3919, Acc=23.33%] 
Train Loss: 1.5729, Train Acc: 42.05%
Val Loss: 3.3919, Val Acc: 23.33%
Best Val Acc: 30.00%

Epoch 5/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.23s/it, Loss=1.6045, Acc=37.50%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.85s/it, Loss=2.8460, Acc=43.33%] 
Train Loss: 1.6024, Train Acc: 37.50%
Val Loss: 2.8460, Val Acc: 43.33%
Best Val Acc: 43.33%

Epoch 6/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.19s/it, Loss=1.4868, Acc=48.86%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.10s/it, Loss=7.0533, Acc=43.33%] 
Train Loss: 1.4701, Train Acc: 48.86%
Val Loss: 7.0533, Val Acc: 43.33%
Best Val Acc: 43.33%

Epoch 7/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.15s/it, Loss=1.5104, Acc=45.45%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.85s/it, Loss=4.0679, Acc=33.33%] 
Train Loss: 1.3803, Train Acc: 45.45%
Val Loss: 4.0679, Val Acc: 33.33%
Best Val Acc: 43.33%

Epoch 8/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.18s/it, Loss=1.2833, Acc=48.86%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.96s/it, Loss=3.6794, Acc=30.00%] 
Train Loss: 1.3450, Train Acc: 48.86%
Val Loss: 3.6794, Val Acc: 30.00%
Best Val Acc: 43.33%

Epoch 9/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.15s/it, Loss=1.1039, Acc=50.00%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.82s/it, Loss=8.5793, Acc=23.33%] 
Train Loss: 1.2096, Train Acc: 50.00%
Val Loss: 8.5793, Val Acc: 23.33%
Best Val Acc: 43.33%

Epoch 10/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.20s/it, Loss=1.6130, Acc=53.41%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.86s/it, Loss=6.6862, Acc=36.67%] 
Train Loss: 1.2028, Train Acc: 53.41%
Val Loss: 6.6862, Val Acc: 36.67%
Best Val Acc: 43.33%

Epoch 11/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.17s/it, Loss=1.6151, Acc=37.50%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.91s/it, Loss=2.7627, Acc=40.00%] 
Train Loss: 1.4554, Train Acc: 37.50%
Val Loss: 2.7627, Val Acc: 40.00%
Best Val Acc: 43.33%

Epoch 12/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.16s/it, Loss=1.3484, Acc=46.59%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.92s/it, Loss=3.2758, Acc=33.33%] 
Train Loss: 1.1889, Train Acc: 46.59%
Val Loss: 3.2758, Val Acc: 33.33%
Best Val Acc: 43.33%

Epoch 13/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.20s/it, Loss=0.9139, Acc=47.73%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.92s/it, Loss=5.1868, Acc=36.67%] 
Train Loss: 1.1395, Train Acc: 47.73%
Val Loss: 5.1868, Val Acc: 36.67%
Best Val Acc: 43.33%

Epoch 14/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.21s/it, Loss=1.4712, Acc=39.77%] 
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.99s/it, Loss=11.2978, Acc=46.67%] 
Train Loss: 1.3747, Train Acc: 39.77%
Val Loss: 11.2978, Val Acc: 46.67%
Best Val Acc: 46.67%

Epoch 15/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.16s/it, Loss=1.4514, Acc=57.95%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.90s/it, Loss=6.2419, Acc=43.33%] 
Train Loss: 1.1745, Train Acc: 57.95%
Val Loss: 6.2419, Val Acc: 43.33%
Best Val Acc: 46.67%

Epoch 16/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.18s/it, Loss=0.8841, Acc=59.09%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.89s/it, Loss=2.2871, Acc=63.33%] 
Train Loss: 0.9366, Train Acc: 59.09%
Val Loss: 2.2871, Val Acc: 63.33%
Best Val Acc: 63.33%

Epoch 17/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.16s/it, Loss=1.0711, Acc=56.82%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.96s/it, Loss=1.5693, Acc=63.33%] 
Train Loss: 1.0892, Train Acc: 56.82%
Val Loss: 1.5693, Val Acc: 63.33%
Best Val Acc: 63.33%

Epoch 18/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.22s/it, Loss=1.1389, Acc=57.95%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.99s/it, Loss=1.4387, Acc=63.33%] 
Train Loss: 1.0273, Train Acc: 57.95%
Val Loss: 1.4387, Val Acc: 63.33%
Best Val Acc: 63.33%

Epoch 19/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.19s/it, Loss=0.8446, Acc=64.77%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.91s/it, Loss=1.3812, Acc=63.33%] 
Train Loss: 0.9091, Train Acc: 64.77%
Val Loss: 1.3812, Val Acc: 63.33%
Best Val Acc: 63.33%

Epoch 20/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.16s/it, Loss=1.0612, Acc=70.45%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.05s/it, Loss=1.2915, Acc=63.33%] 
Train Loss: 0.9548, Train Acc: 70.45%
Val Loss: 1.2915, Val Acc: 63.33%
Best Val Acc: 63.33%

Epoch 21/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.17s/it, Loss=0.6475, Acc=72.73%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.89s/it, Loss=1.2550, Acc=60.00%] 
Train Loss: 0.8437, Train Acc: 72.73%
Val Loss: 1.2550, Val Acc: 60.00%
Best Val Acc: 63.33%

Epoch 22/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.17s/it, Loss=0.8452, Acc=68.18%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.94s/it, Loss=1.2463, Acc=63.33%] 
Train Loss: 0.8146, Train Acc: 68.18%
Val Loss: 1.2463, Val Acc: 63.33%
Best Val Acc: 63.33%

Epoch 23/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.22s/it, Loss=0.7185, Acc=71.59%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.94s/it, Loss=1.2131, Acc=63.33%] 
Train Loss: 0.8006, Train Acc: 71.59%
Val Loss: 1.2131, Val Acc: 63.33%
Best Val Acc: 63.33%

Epoch 24/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.22s/it, Loss=0.7479, Acc=71.59%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.07s/it, Loss=1.2408, Acc=66.67%] 
Train Loss: 0.8269, Train Acc: 71.59%
Val Loss: 1.2408, Val Acc: 66.67%
Best Val Acc: 66.67%

Epoch 25/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.19s/it, Loss=0.9763, Acc=65.91%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.05s/it, Loss=1.2417, Acc=63.33%] 
Train Loss: 0.8412, Train Acc: 65.91%
Val Loss: 1.2417, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 26/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.23s/it, Loss=0.6827, Acc=71.59%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.98s/it, Loss=1.3084, Acc=56.67%] 
Train Loss: 0.6866, Train Acc: 71.59%
Val Loss: 1.3084, Val Acc: 56.67%
Best Val Acc: 66.67%

Epoch 27/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.18s/it, Loss=0.7715, Acc=72.73%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.17s/it, Loss=1.3764, Acc=53.33%] 
Train Loss: 0.7504, Train Acc: 72.73%
Val Loss: 1.3764, Val Acc: 53.33%
Best Val Acc: 66.67%

Epoch 28/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.13s/it, Loss=0.5039, Acc=77.27%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.99s/it, Loss=1.4524, Acc=53.33%] 
Train Loss: 0.6161, Train Acc: 77.27%
Val Loss: 1.4524, Val Acc: 53.33%
Best Val Acc: 66.67%

Epoch 29/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.22s/it, Loss=0.6843, Acc=76.14%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.90s/it, Loss=1.4801, Acc=53.33%] 
Train Loss: 0.6281, Train Acc: 76.14%
Val Loss: 1.4801, Val Acc: 53.33%
Best Val Acc: 66.67%

Epoch 30/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.17s/it, Loss=0.7315, Acc=73.86%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.17s/it, Loss=1.5607, Acc=53.33%] 
Train Loss: 0.6585, Train Acc: 73.86%
Val Loss: 1.5607, Val Acc: 53.33%
Best Val Acc: 66.67%

Epoch 31/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.21s/it, Loss=0.7365, Acc=67.05%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.16s/it, Loss=1.4667, Acc=53.33%] 
Train Loss: 0.7682, Train Acc: 67.05%
Val Loss: 1.4667, Val Acc: 53.33%
Best Val Acc: 66.67%

Epoch 32/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.20s/it, Loss=0.6337, Acc=72.73%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.88s/it, Loss=1.3478, Acc=53.33%] 
Train Loss: 0.6827, Train Acc: 72.73%
Val Loss: 1.3478, Val Acc: 53.33%
Best Val Acc: 66.67%

Epoch 33/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.28s/it, Loss=0.6660, Acc=73.86%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.13s/it, Loss=1.3320, Acc=56.67%] 
Train Loss: 0.6717, Train Acc: 73.86%
Val Loss: 1.3320, Val Acc: 56.67%
Best Val Acc: 66.67%

Epoch 34/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.18s/it, Loss=0.6497, Acc=71.59%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.88s/it, Loss=1.2731, Acc=63.33%] 
Train Loss: 0.6821, Train Acc: 71.59%
Val Loss: 1.2731, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 35/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.18s/it, Loss=0.7229, Acc=79.55%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.89s/it, Loss=1.2163, Acc=63.33%] 
Train Loss: 0.6468, Train Acc: 79.55%
Val Loss: 1.2163, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 36/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.17s/it, Loss=0.6245, Acc=76.14%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.83s/it, Loss=1.2023, Acc=63.33%] 
Train Loss: 0.6696, Train Acc: 76.14%
Val Loss: 1.2023, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 37/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.20s/it, Loss=0.6515, Acc=72.73%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.07s/it, Loss=1.1730, Acc=63.33%] 
Train Loss: 0.6657, Train Acc: 72.73%
Val Loss: 1.1730, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 38/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.15s/it, Loss=0.6865, Acc=82.95%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.96s/it, Loss=1.1590, Acc=63.33%] 
Train Loss: 0.6141, Train Acc: 82.95%
Val Loss: 1.1590, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 39/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.18s/it, Loss=0.7742, Acc=76.14%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.95s/it, Loss=1.1692, Acc=63.33%] 
Train Loss: 0.6770, Train Acc: 76.14%
Val Loss: 1.1692, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 40/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.22s/it, Loss=0.9375, Acc=73.86%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.74s/it, Loss=1.1812, Acc=63.33%] 
Train Loss: 0.6932, Train Acc: 73.86%
Val Loss: 1.1812, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 41/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.19s/it, Loss=0.4389, Acc=73.86%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.82s/it, Loss=1.1640, Acc=63.33%] 
Train Loss: 0.6504, Train Acc: 73.86%
Val Loss: 1.1640, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 42/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.20s/it, Loss=0.6634, Acc=80.68%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.87s/it, Loss=1.1485, Acc=63.33%] 
Train Loss: 0.5899, Train Acc: 80.68%
Val Loss: 1.1485, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 43/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.17s/it, Loss=0.9164, Acc=72.73%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.89s/it, Loss=1.1497, Acc=63.33%] 
Train Loss: 0.6820, Train Acc: 72.73%
Val Loss: 1.1497, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 44/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.18s/it, Loss=0.7093, Acc=73.86%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.06s/it, Loss=1.1035, Acc=63.33%] 
Train Loss: 0.6832, Train Acc: 73.86%
Val Loss: 1.1035, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 45/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.14s/it, Loss=0.5834, Acc=72.73%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.98s/it, Loss=1.1013, Acc=63.33%] 
Train Loss: 0.6425, Train Acc: 72.73%
Val Loss: 1.1013, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 46/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.15s/it, Loss=0.5984, Acc=73.86%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.95s/it, Loss=1.1081, Acc=63.33%] 
Train Loss: 0.5989, Train Acc: 73.86%
Val Loss: 1.1081, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 47/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.15s/it, Loss=0.6500, Acc=76.14%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.98s/it, Loss=1.1365, Acc=63.33%] 
Train Loss: 0.6387, Train Acc: 76.14%
Val Loss: 1.1365, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 48/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.15s/it, Loss=0.4631, Acc=81.82%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.84s/it, Loss=1.1495, Acc=63.33%] 
Train Loss: 0.5177, Train Acc: 81.82%
Val Loss: 1.1495, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 49/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.23s/it, Loss=0.6751, Acc=69.32%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.90s/it, Loss=1.1606, Acc=63.33%] 
Train Loss: 0.7148, Train Acc: 69.32%
Val Loss: 1.1606, Val Acc: 63.33%
Best Val Acc: 66.67%

Epoch 50/50
----------------------------------------
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.18s/it, Loss=0.5969, Acc=77.27%] 
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.93s/it, Loss=1.1525, Acc=63.33%] 
Train Loss: 0.5552, Train Acc: 77.27%
Val Loss: 1.1525, Val Acc: 63.33%
Best Val Acc: 66.67%

训练完成！总用时: 10.45 分钟

在测试集上评估...
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:06<00:00,  6.13s/it, Loss=1.0767, Acc=60.00%] 
Test Loss: 1.0767, Test Acc: 60.00%

分类报告:
                  precision    recall  f1-score   support

   20CS19764 鼠皮树       0.50      0.25      0.33         4
       DH001 粽叶芦       0.55      1.00      0.71         6
        JL001 怀槐       0.50      0.57      0.53         7
       JL005 蒙古栎       1.00      0.50      0.67         6
LiYLXWZW002 长叶水麻       0.00      0.00      0.00         3
    XZYGX023 硬头黄       1.00      1.00      1.00         4

        accuracy                           0.60        30
       macro avg       0.59      0.55      0.54        30
    weighted avg       0.63      0.60      0.58        30


模型已保存为: fiber_classifier_resnet50_electron.pth

绘制训练历史...
绘制混淆矩阵...
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 40736 (\N{CJK UNIFIED IDEOGRAPH-9F20}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 30382 (\N{CJK UNIFIED IDEOGRAPH-76AE}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 26641 (\N{CJK UNIFIED IDEOGRAPH-6811}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 31933 (\N{CJK UNIFIED IDEOGRAPH-7CBD}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 21494 (\N{CJK UNIFIED IDEOGRAPH-53F6}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 33446 (\N{CJK UNIFIED IDEOGRAPH-82A6}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 24576 (\N{CJK UNIFIED IDEOGRAPH-6000}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 27088 (\N{CJK UNIFIED IDEOGRAPH-69D0}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 33945 (\N{CJK UNIFIED IDEOGRAPH-8499}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 21476 (\N{CJK UNIFIED IDEOGRAPH-53E4}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 26638 (\N{CJK UNIFIED IDEOGRAPH-680E}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 38271 (\N{CJK UNIFIED IDEOGRAPH-957F}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 27700 (\N{CJK UNIFIED IDEOGRAPH-6C34}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 40635 (\N{CJK UNIFIED IDEOGRAPH-9EBB}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 30828 (\N{CJK UNIFIED IDEOGRAPH-786C}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 22836 (\N{CJK UNIFIED IDEOGRAPH-5934}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\site-packages\seaborn\utils.py:61: UserWarning: Glyph 40644 (\N{CJK UNIFIED IDEOGRAPH-9EC4}) missing from font(s) DejaVu Sans.
  fig.canvas.draw()
e:\CODE\SRP\train.py:291: UserWarning: Glyph 40736 (\N{CJK UNIFIED IDEOGRAPH-9F20}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 30382 (\N{CJK UNIFIED IDEOGRAPH-76AE}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 26641 (\N{CJK UNIFIED IDEOGRAPH-6811}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 31933 (\N{CJK UNIFIED IDEOGRAPH-7CBD}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 21494 (\N{CJK UNIFIED IDEOGRAPH-53F6}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 33446 (\N{CJK UNIFIED IDEOGRAPH-82A6}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 24576 (\N{CJK UNIFIED IDEOGRAPH-6000}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 27088 (\N{CJK UNIFIED IDEOGRAPH-69D0}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 33945 (\N{CJK UNIFIED IDEOGRAPH-8499}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 21476 (\N{CJK UNIFIED IDEOGRAPH-53E4}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 26638 (\N{CJK UNIFIED IDEOGRAPH-680E}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 38271 (\N{CJK UNIFIED IDEOGRAPH-957F}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 27700 (\N{CJK UNIFIED IDEOGRAPH-6C34}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 40635 (\N{CJK UNIFIED IDEOGRAPH-9EBB}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 30828 (\N{CJK UNIFIED IDEOGRAPH-786C}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 22836 (\N{CJK UNIFIED IDEOGRAPH-5934}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
e:\CODE\SRP\train.py:291: UserWarning: Glyph 40644 (\N{CJK UNIFIED IDEOGRAPH-9EC4}) missing from font(s) DejaVu Sans.
  plt.savefig(filename, dpi=300, bbox_inches='tight')
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 40736 (\N{CJK UNIFIED IDEOGRAPH-9F20}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 30382 (\N{CJK UNIFIED IDEOGRAPH-76AE}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 26641 (\N{CJK UNIFIED IDEOGRAPH-6811}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 31933 (\N{CJK UNIFIED IDEOGRAPH-7CBD}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 21494 (\N{CJK UNIFIED IDEOGRAPH-53F6}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 33446 (\N{CJK UNIFIED IDEOGRAPH-82A6}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 24576 (\N{CJK UNIFIED IDEOGRAPH-6000}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 27088 (\N{CJK UNIFIED IDEOGRAPH-69D0}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 33945 (\N{CJK UNIFIED IDEOGRAPH-8499}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 21476 (\N{CJK UNIFIED IDEOGRAPH-53E4}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 26638 (\N{CJK UNIFIED IDEOGRAPH-680E}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 38271 (\N{CJK UNIFIED IDEOGRAPH-957F}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 27700 (\N{CJK UNIFIED IDEOGRAPH-6C34}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 40635 (\N{CJK UNIFIED IDEOGRAPH-9EBB}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 30828 (\N{CJK UNIFIED IDEOGRAPH-786C}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 22836 (\N{CJK UNIFIED IDEOGRAPH-5934}) missing from font(s) DejaVu Sans.
  func(*args)
C:\Users\cmz\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py:861: UserWarning: Glyph 40644 (\N{CJK UNIFIED IDEOGRAPH-9EC4}) missing from font(s) DejaVu Sans.
  func(*args)

ELECTRON 模型训练完成！

============================================================
所有模型训练完成！
============================================================
光镜模型测试准确率: 86.67%
电镜模型测试准确率: 60.00%

模型文件:
- fiber_classifier_resnet50_optical.pth
- fiber_classifier_resnet50_electron.pth

图表文件:
- training_history_optical.png
- training_history_electron.png
- confusion_matrix_optical.png
- confusion_matrix_electron.png

训练摘要已保存为: training_summary.json
PS E:\CODE\SRP> 