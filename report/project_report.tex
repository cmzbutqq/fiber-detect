\documentclass[12pt]{beamer}
\usepackage[UTF8]{ctex}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}

% 主题设置
\usetheme{Madrid}
\usecolortheme{default}

% 标题信息
\title{基于深度学习的植物纤维图像分类系统}
\subtitle{ResNet-50迁移学习方法研究与实现}
\author{项目汇报}
\institute{植物纤维识别项目组}
\date{\today}

% 自定义颜色
\definecolor{darkblue}{RGB}{0,51,102}
\definecolor{lightblue}{RGB}{173,216,230}
\definecolor{darkgreen}{RGB}{0,100,0}

\begin{document}

% 标题页
\frame{\titlepage}

% 目录
\begin{frame}
\frametitle{汇报大纲}
\tableofcontents
\end{frame}

% 第一部分：项目概述
\section{项目概述}

\begin{frame}
\frametitle{项目背景与目标}
\begin{itemize}
    \item \textbf{研究背景}：植物纤维识别在材料科学、生物学研究中具有重要意义
    \item \textbf{项目目标}：开发基于深度学习的植物纤维自动分类系统
    \item \textbf{技术路线}：采用ResNet-50预训练模型进行迁移学习
    \item \textbf{应用价值}：提高纤维识别效率，减少人工成本
\end{itemize}

\vspace{0.5cm}
\begin{block}{核心创新点}
\begin{itemize}
    \item 多模态图像融合（光镜+电镜）
    \item 数据不平衡处理策略
    \item 端到端深度学习分类框架
\end{itemize}
\end{block}
\end{frame}

\begin{frame}
\frametitle{数据集概况}
\begin{columns}
\begin{column}{0.5\textwidth}
\textbf{数据集统计：}
\begin{itemize}
    \item 总图像数量：\textcolor{darkblue}{295张}
    \item 光镜图像：147张 (49.8\%)
    \item 电镜图像：148张 (50.2\%)
    \item 植物类别：6种
\end{itemize}

\vspace{0.3cm}
\textbf{图像特征：}
\begin{itemize}
    \item 主要尺寸：1600×1200像素
    \item 文件格式：TIFF、PNG
    \item 平均大小：3.78MB
\end{itemize}
\end{column}

\begin{column}{0.5\textwidth}
\textbf{类别分布：}
\begin{table}[h]
\centering
\small
\begin{tabular}{lc}
\toprule
\textbf{植物类别} & \textbf{图像数量} \\
\midrule
粽叶芦 & 65 \\
怀槐 & 54 \\
硬头黄 & 52 \\
长叶水麻 & 49 \\
鼠皮树 & 42 \\
蒙古栎 & 33 \\
\bottomrule
\end{tabular}
\end{table}
\end{column}
\end{columns}
\end{frame}

% 第二部分：技术方案
\section{技术方案}

\begin{frame}
\frametitle{系统架构设计}
\begin{center}
\begin{tikzpicture}[node distance=2cm, auto,
    process/.style={rectangle, minimum width=2.5cm, minimum height=1cm, text centered, draw=black, fill=lightblue},
    data/.style={ellipse, minimum width=2cm, minimum height=0.8cm, text centered, draw=black, fill=yellow!30},
    arrow/.style={thick,->,>=stealth}]
    
    % 节点定义
    \node [data] (input) {原始图像};
    \node [process, below of=input] (preprocess) {数据预处理};
    \node [process, below of=preprocess] (augment) {数据增强};
    \node [process, below of=augment] (model) {ResNet-50模型};
    \node [data, below of=model] (output) {分类结果};
    
    % 连接线
    \draw [arrow] (input) -- (preprocess);
    \draw [arrow] (preprocess) -- (augment);
    \draw [arrow] (augment) -- (model);
    \draw [arrow] (model) -- (output);
    
    % 侧边注释
    \node [right of=preprocess, node distance=3cm] {尺寸调整、标准化};
    \node [right of=augment, node distance=3cm] {翻转、旋转、颜色变换};
    \node [right of=model, node distance=3cm] {迁移学习、微调};
\end{tikzpicture}
\end{center}
\end{frame}

\begin{frame}
\frametitle{ResNet-50模型架构}
\begin{columns}
\begin{column}{0.6\textwidth}
\textbf{网络结构：}
\begin{itemize}
    \item \textbf{骨干网络}：ResNet-50 (ImageNet预训练)
    \item \textbf{特征提取}：2048维特征向量
    \item \textbf{分类头}：全连接层 + Dropout
    \item \textbf{输出层}：6类softmax分类
\end{itemize}

\vspace{0.3cm}
\textbf{迁移学习策略：}
\begin{itemize}
    \item 冻结前期卷积层参数
    \item 微调后期特征层
    \item 重新训练分类头
\end{itemize}
\end{column}

\begin{column}{0.4\textwidth}
\begin{block}{模型参数}
\small
\begin{itemize}
    \item 输入尺寸：224×224×3
    \item 批次大小：32
    \item 学习率：0.001
    \item 优化器：Adam
    \item 训练轮数：50
    \item 权重衰减：1e-4
\end{itemize}
\end{block}
\end{column}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{ResNet-50理论基础}
\textbf{残差学习原理：}
\begin{itemize}
    \item 解决深度网络梯度消失问题
    \item 引入跳跃连接（Skip Connection）
    \item 学习残差映射而非直接映射
\end{itemize}

\vspace{0.3cm}
\textbf{残差块数学表达：}
\[
\mathbf{y} = \mathcal{F}(\mathbf{x}, \{W_i\}) + \mathbf{x}
\]
其中 \(\mathcal{F}(\mathbf{x}, \{W_i\})\) 表示残差映射，\(\mathbf{x}\) 为输入。

\vspace{0.3cm}
\textbf{Bottleneck设计：}
\[
\begin{aligned}
\mathbf{z}_1 &= \text{ReLU}(\text{BN}(\text{Conv}_{1×1}(\mathbf{x}))) \\
\mathbf{z}_2 &= \text{ReLU}(\text{BN}(\text{Conv}_{3×3}(\mathbf{z}_1))) \\
\mathbf{z}_3 &= \text{BN}(\text{Conv}_{1×1}(\mathbf{z}_2)) \\
\mathbf{y} &= \text{ReLU}(\mathbf{z}_3 + \mathbf{x})
\end{aligned}
\]
\end{frame}

\begin{frame}
\frametitle{损失函数与优化}
\textbf{交叉熵损失函数：}
\[
\mathcal{L} = -\frac{1}{N}\sum_{i=1}^{N}\sum_{j=1}^{C} y_{ij} \log(\hat{y}_{ij})
\]
其中 \(N\) 为批次大小，\(C\) 为类别数，\(y_{ij}\) 为真实标签，\(\hat{y}_{ij}\) 为预测概率。

\vspace{0.3cm}
\textbf{Softmax激活函数：}
\[
\hat{y}_{ij} = \frac{\exp(z_{ij})}{\sum_{k=1}^{C} \exp(z_{ik})}
\]

\vspace{0.3cm}
\textbf{Adam优化器更新规则：}
\[
\begin{aligned}
\mathbf{m}_t &= \beta_1 \mathbf{m}_{t-1} + (1-\beta_1) \nabla_{\theta} \mathcal{L}_t \\
\mathbf{v}_t &= \beta_2 \mathbf{v}_{t-1} + (1-\beta_2) (\nabla_{\theta} \mathcal{L}_t)^2 \\
\hat{\mathbf{m}}_t &= \frac{\mathbf{m}_t}{1-\beta_1^t}, \quad \hat{\mathbf{v}}_t = \frac{\mathbf{v}_t}{1-\beta_2^t} \\
\theta_{t+1} &= \theta_t - \frac{\alpha}{\sqrt{\hat{\mathbf{v}}_t} + \epsilon} \hat{\mathbf{m}}_t
\end{aligned}
\]
\end{frame}

\begin{frame}
\frametitle{数据处理策略}
\begin{columns}
\begin{column}{0.5\textwidth}
\textbf{数据预处理：}
\begin{itemize}
    \item 图像尺寸标准化：224×224
    \item RGB格式转换
    \item ImageNet标准化
    \item 多格式支持（TIFF/PNG/JPG）
\end{itemize}

\vspace{0.3cm}
\textbf{数据增强：}
\begin{itemize}
    \item 随机水平/垂直翻转
    \item 随机旋转（±30°）
    \item 颜色抖动变换
    \item 随机裁剪
\end{itemize}
\end{column}

\begin{column}{0.5\textwidth}
\textbf{数据集划分：}
\begin{itemize}
    \item 训练集：70\%
    \item 验证集：15\%
    \item 测试集：15\%
    \item 分层采样保证类别平衡
\end{itemize}

\vspace{0.3cm}
\textbf{不平衡处理：}
\begin{itemize}
    \item 加权随机采样
    \item 类别权重调整
    \item 数据增强补偿
\end{itemize}
\end{column}
\end{columns}
\end{frame}

% 第三部分：实验结果
\section{实验结果}

\begin{frame}
\frametitle{训练过程监控}
\begin{columns}
\begin{column}{0.5\textwidth}
\begin{figure}
\centering
\includegraphics[width=\textwidth]{training_history.png}
\caption{训练历史曲线}
\end{figure}
\end{column}

\begin{column}{0.5\textwidth}
\textbf{训练特点：}
\begin{itemize}
    \item 损失函数快速收敛
    \item 验证准确率稳步提升
    \item 无明显过拟合现象
    \item 学习率调度有效
\end{itemize}

\vspace{0.3cm}
\begin{block}{关键指标}
\begin{itemize}
    \item 最佳验证准确率：\textcolor{darkgreen}{47.46\%}
    \item 测试集准确率：\textcolor{darkgreen}{44.07\%}
    \item 训练时间：约33分钟
\end{itemize}
\end{block}
\end{column}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{分类性能评估}
\begin{columns}
\begin{column}{0.5\textwidth}
\begin{figure}
\centering
\includegraphics[width=\textwidth]{confusion_matrix.png}
\caption{混淆矩阵}
\end{figure}
\end{column}

\begin{column}{0.5\textwidth}
\textbf{性能分析：}
\begin{itemize}
    \item 鼠皮树精确率最高(1.00)但召回率较低(0.25)
    \item 长叶水麻表现相对稳定(F1=0.67)
    \item 硬头黄召回率较高(0.80)但精确率偏低
    \item 数据不平衡导致分类效果有待提升
\end{itemize}

\vspace{0.3cm}
\begin{block}{评估指标}
\small
\begin{itemize}
    \item 宏平均精确率：57\%
    \item 宏平均召回率：42\%
    \item 宏平均F1分数：41\%
    \item 加权平均准确率：44.07\%
\end{itemize}
\end{block}
\end{column}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{数据集分析可视化}
\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{dataset_analysis.png}
\caption{数据集统计分析图表}
\end{figure}

\begin{itemize}
    \item 类别分布相对均衡，但存在一定不平衡
    \item 光镜与电镜图像数量基本相等
    \item 图像尺寸较为统一，有利于模型训练
\end{itemize}
\end{frame}

% 第四部分：项目成果
\section{项目成果}

\begin{frame}
\frametitle{项目交付物}
\begin{columns}
\begin{column}{0.5\textwidth}
\textbf{核心代码模块：}
\begin{itemize}
    \item \texttt{train.py} - 模型训练脚本
    \item \texttt{predict.py} - 预测推理脚本
    \item \texttt{analyze\_dataset.py} - 数据分析工具
\end{itemize}

\vspace{0.3cm}
\textbf{配置文件：}
\begin{itemize}
    \item \texttt{config.json} - 训练参数配置
    \item \texttt{requirements.txt} - 依赖包列表
    \item \texttt{.gitignore} - 版本控制配置
\end{itemize}
\end{column}

\begin{column}{0.5\textwidth}
\textbf{模型文件：}
\begin{itemize}
    \item 训练好的ResNet-50模型
    \item 模型权重和配置信息
    \item 类别映射关系
\end{itemize}

\vspace{0.3cm}
\textbf{分析报告：}
\begin{itemize}
    \item 数据集统计报告（JSON）
    \item 训练历史可视化
    \item 混淆矩阵分析
    \item 性能评估报告
\end{itemize}
\end{column}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{技术特色与创新}
\begin{block}{技术亮点}
\begin{itemize}
    \item \textbf{多模态融合}：统一处理光镜和电镜图像，提升模型泛化能力
    \item \textbf{迁移学习}：充分利用ImageNet预训练权重，加速收敛
    \item \textbf{数据增强}：丰富的增强策略，提高模型鲁棒性
    \item \textbf{不平衡处理}：加权采样策略，解决类别不均衡问题
\end{itemize}
\end{block}

\begin{block}{工程实践}
\begin{itemize}
    \item \textbf{模块化设计}：代码结构清晰，易于维护和扩展
    \item \textbf{完整文档}：详细的README和代码注释
    \item \textbf{可视化分析}：丰富的图表和统计信息
    \item \textbf{自动化流程}：一键训练和预测功能
\end{itemize}
\end{block}
\end{frame}

% 第五部分：总结与展望
\section{总结与展望}

\begin{frame}
\frametitle{项目总结}
\begin{block}{已完成工作}
\begin{itemize}
    \item ✅ 完成数据集收集和预处理
    \item ✅ 实现基于ResNet-50的分类模型
    \item ✅ 完成模型训练和性能评估
    \item ✅ 开发预测和分析工具
    \item ✅ 生成完整的项目文档
\end{itemize}
\end{block}

\begin{block}{关键成果}
\begin{itemize}
    \item 实现了\textcolor{darkgreen}{44.07\%}的测试准确率
    \item 建立了完整的纤维分类流水线
    \item 识别了数据不平衡等关键问题
    \item 形成了标准化的开发流程
\end{itemize}
\end{block}
\end{frame}

\begin{frame}
\frametitle{未来改进方向}
\begin{columns}
\begin{column}{0.5\textwidth}
\textbf{模型优化：}
\begin{itemize}
    \item 尝试更先进的网络架构
    \item 实现模型集成策略
    \item 引入注意力机制
    \item 探索自监督学习
\end{itemize}

\vspace{0.3cm}
\textbf{数据扩充：}
\begin{itemize}
    \item 收集更多样本数据
    \item 平衡各类别分布
    \item 引入生成对抗网络
    \item 跨域数据增强
\end{itemize}
\end{column}

\begin{column}{0.5\textwidth}
\textbf{应用部署：}
\begin{itemize}
    \item 开发Web应用界面
    \item 实现移动端应用
    \item 模型压缩和加速
    \item 边缘设备部署
\end{itemize}

\vspace{0.3cm}
\textbf{功能扩展：}
\begin{itemize}
    \item 多尺度特征融合
    \item 细粒度分类识别
    \item 实时检测定位
    \item 质量评估功能
\end{itemize}
\end{column}
\end{columns}
\end{frame}



\end{document}